---
title: "Bayesian Cost Modeling"
author: "Grayson White"
date: "7/29/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Load packages
library(tidyverse)
library(tidymodels)
```

```{r}
# Load data
usda_cost <- read_csv("../usda_cost.csv")
usda_cost <- usda_cost %>%
  select(-X1) %>%
  rename(Population = Population.x)
```

```{r}
# Make the model
## Set seed
set.seed(3737)

## Specify priors
prior_dist <- rstanarm::student_t(df = 1)

## Create model
bayes_mod <-
  linear_reg() %>% 
  set_engine("stan", 
             prior_intercept = prior_dist, 
             prior = prior_dist) 

## Train
bayes_fit <-
  bayes_mod %>%
  fit(`Total Cost` ~ Population + basic_treatment, data = usda_cost)

bayes_fit
```

```{r}
m1 <- lm(`Total Cost` ~ Population + basic_treatment, data = usda_cost)
summary(m1)
```


